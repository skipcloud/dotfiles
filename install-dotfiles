#!/bin/zsh
local conf_dir=$HOME/.config
local stow_dirs=("irb" "pry" "tmux" "git")
local xdg_dirs=("nvim" "dlv" "zsh" "tmux" "rubocop")

if ! type stow >/dev/null; then
  echo "stow is not installed, please install and retry" >&2
  exit 1
fi

for i in "${stow_dirs[@]}"
do
  echo "Intalling ${i} in \$HOME"
  stow --dotfiles $i
done

# This is the only one that needs to be toplevel for some reason
echo "Installing pycodestyle to top level of \$XDG_CONFIG_HOME"
stow --target $conf_dir pycodestyle

# Install XDG config stuff
for dir in ${xdg_dirs[@]} ; do
	echo "Installing $dir in \$XDG_CONFIG_HOME"
	[[ ! -d $conf_dir/$dir ]] && mkdir --parents $conf_dir/$dir
	stow --target $conf_dir/$dir $dir
done

# zshenv must be in the home directory so symlink it
echo "symlinking zshenv to home directory"
ln --symbolic --force $conf_dir/zsh/.zshenv $HOME/.zshenv
